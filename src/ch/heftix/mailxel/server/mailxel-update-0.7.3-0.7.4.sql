-- Copyright (C) 2007-2009 by Simon Hefti. All rights reserved.
--
-- Licensed under the EPL 1.0 (Eclipse Public License).
-- (see http://www.eclipse.org/legal/epl-v10.html)
--
-- Software distributed under the License is distributed on an "AS IS"
-- basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.
--
-- Initial Developer: Simon Hefti

-- personalized icons
create table icon (
  id integer primary key,
  name text, --  
  data blob
);

insert into sequence values ('icon',           1000);

INSERT INTO icon VALUES(999,'act.png',     X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C0000029A4944415478DA7C93DF4B936114C7CF7EA838F7AEB9B981AB982BD91A6C928E8AA14DC809A1CCA89B181B195DAC5150B262F6F30F2808BCE8A25910416A4217A2B12B2F7205DEBC831C0861B0528613C2E57CD7B6777BDD3A672A0DD30E7C78CFF33CE77CCFF39CE77D4480A6D168A0BBBB1BAACC8708480A592F954A2BC81AC2170A05D8DADAAA04C5E3719090E3743A2B93552C226BC5625167B55A3B8D4663EFC6C64673369B95A0C87AB95C2671686C6CDC1630994CB0C72860130596138984DAEFF75F73B95C97188639BCB4B424CAE572DFB14001C50E1400AC06994C46E079BE98CFE7B5168BA54BA7D3990D0643D3ECEC6C4210846F0848611FC30A904C267787ABB1586C85E6D2E934E8F57A3B0A6BE9A828BE2D303D3DFD8F88542A05B95C0E32998C138BC595046A201EAB86E3B81A1CB7E1CE627090918042A1808E8E8E60381C5EB0DBEDCFE87650ECDEDCDCDCB25AADF6A954AA9EFF0928CD66737066666601CF1DAC5A6A2391542A55DEB9EE7DED3C126559B65C9DAC1FB8032D17EE82F244670F89E054EB7EC983C897E1E161AAF01B5136F7DE84F6A78B70F6E52A385E254388F748DF502558B427F91172D9E170582291481EFDABADBED7934CEBE9CAA204FB22ADAD65C9C79F692497C9BC1557255393BCFDFDFD94CCA3FF507BEEFA64BDBE3D841D678902CFB3598E83C18B2D364C1E2A974ADEDD1D8C202EB7DB7D6C6262A288FE0BE4D6F1FB9F688DBD7DA3CBF675138013FE56D3D6014CBDF91C2581E7C880CFE73B3A3A3A4AAFE41DED848298335E909FF284B092ADFA9C2D9E3EDB8FB1705424165361F8190804A861943C8534212A6A1EA2201DA401A947EA18CF7894F18E471B7A1F5FA11ED25B50CDCFCF77E1F703F2603710A9456A76A038EA97A874C87052F89578CF7F7C3246D5FF083000ADA22BE681965B640000000049454E44AE426082');
INSERT INTO icon VALUES(998,'clock_go.png',X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000002E94944415478DAA492DB4B545114C6BF73D1712ECC4CEA7499461B671C0D1BEC260A950583096520F9302A24F5E0833D06D143451154FF81F5A24F0A8A86CA88E0431862544E17F282E465726EE02567423DA39E3397D3DEC79988E8AD05DF399CB5D7EF5B67EFBD98A17B2CD4D9CC119E431D002BF6C39F4862C4F92C554D3F661FB013FF5ADF95E4155E8CC3C264691F9E3CEFBE70B8B0DC268A7B783D32B09525FA1B5258DBA4D52267BA25A8AC676AEA1AF42A550E5683D3DFA7C6FB2AC4B8F094DFDA916F965DACBF6C3095DA82FE002627BDC82B6F54173BABAF64DF2956DA1DFFB184A5D90978860650555509D3A1D213B68A7AF587D1EE10BF23E1ACCCB29699292FE6E7FD30B89EC3E174C2A8D160703488A305166872EC38E83443D039313E761FA5A556180F682C9465C93ED4C9BD283335F54D814B1C0EE8D56AA5B36F69112999C15A44C6DBCF2CB28811ADA1B594A12C2BC53137F6665A349D72C366B341939D0D966114034110C0B1805EC7C26A56E1FD1709C6DC22984EBB4119CAB2B28C17DB91C0FCB1B2730AB4B5BB8BC0C686227F20880831A1DA1663C8CBE530E1FD8992F24BA00C6559C71CE3BBF68A59CFD19993E92BC2B1FC7C45DBDB04D2E97ECB6E31E2E3D70D68F596246528CBDBE680042065B12C926998C6D59A1AB85C2EDC7DD48B14A3850C9E8801C37160492D6528CBC7F79BAE6843A1188A8AF499BFE8E9EBC38DE666787ADA322962006C4A12B8703846B8159A63A901D1A7F8F0F01A4FDC13A994526CC8CD45774F8FF2CE48673442456E68CFE35953186A2091C71E30B2DED5B590130E0BC9B441C6E4CF489135C3EAAA10EEEC5CA08CA41890A34CC8F2AA108DB62FB6B4CCC8CBCB318EECF1EFA0392E188CCD3435CD6C4522ED94A12CDF6636676AC4CA6834D4585B1BB3B7B63A0ADCEE7CADDDAE4CD48ECFB71BE8EFDF58EAE858EC4D24A25EB359CC408C3A3D75E4646F1B18C6F7441066C9615D27293A1885E9BA20D13B325E838F753AE7A62CDBC9765E2A06B22CE37FE29700030007544F4DCEB8CF840000000049454E44AE426082');
INSERT INTO icon VALUES(997,'to_me.png',   X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000000017352474200AECE1CE900000006624B474400FF00FF00FFA0BDA793000000097048597300000B1300000B1301009A9C180000000774494D4507DA0215112624804FCF96000002884944415438CB95915F48536118C69F73E6E636DD96E872D35466E61F966B62A14D2FB2C22414E288104341080A8920A2A81B05BBEBA6AB6E065D647F60775E682625649A5AA64CD4412D9B88E110860B9DFBCEF9CECEF9BA3109B78A9E9B171E7EEFC3CBF37248A3028E3372C065008D7BD67B06F837184B1C6433905E5D154EE7B5BA86864A2ACBF83039E95E5D59D102F01D04F974DB2AD07AB8A0C0B9158B19A2D1A821C76A75AA406B3A36ED052A638E5BDD1EDDF1723B00603914D1B54E4F3BD2B12917F8DAF87EA3D95CE87639C01803630C6E970346B3B9D0D7C6F7FF334065E0BD6E29281382A424212949900981D72D055596CAA7183DC36AAF2D5B0EC536234422041221886D46882D5B0EF50CABBD7F0C10A63A7DC254672700282AF3CF8F8F84255184248A981F1F092B2AF3FFB5C478325E0BA0B6F9DD25DC1EB8F9F27EA0699B19AC008060606EBBAFE4ED27E04C4A80A671A879AED87BF4AA2CC9E873DFAB7D159AA8D268495DBDC6E43AE7A931D9EC767CD931658C253D8CAFE9262C30B0F17B00F764F505238AB86F58B4663C9B194593ECC595A20500C0E3F513B05436E2FAA3898700C260EAA8F2B4E51B0068C247BEB77D0C2EEDCC2EAF7045A5B9C6C1B149545BDB91E4AB40E271ACEE5AB096590D8B250B67ABEDA73928B9F15DE24C1C6BDF624BFE357EF1CEECC9CF811B6FB2A83EE7F5E03C4AB81694E737439665088200411040290500241214A74A73EBBA9ACA3A90143B7E9558CFD6675CDAFC1C3EEF5005F20C55A02201A514D1685405004AE9FEB71863D0F29C11E28F6200460EC079BEE2E205D8DCF5E03494E94C09A6CF8973BA2CE2FAFA60060016CBEE7AA0D24C4E91F49C22E9A1CA3A440213CAC2F3210E801640D1DEFC1FC900D67F026A931264BFFBAF6B0000000049454E44AE426082');

alter table msgquery add count integer;
update msgquery set count=0;

delete from msgquery where id  < 1000;

insert into msgquery (count,id,iconid,shortname,name,sql) values (0,999,999,'ACT','unanswered messages to me',  'select distinct m.id from message m, address a, addressxmessage axm, category c, categoryxmessage cxm where axm.messageid=m.id and axm.addressid=a.id and axm.type=''T'' and cxm.current=1 and cxm.messageid=m.id and cxm.categoryid not in (select id from category where shortname in (''DON'',''ANS'',''IGN'',''TON'')) and a.id in (select id from address where shortname=(select shortname from address where address=(select v from conf where k=''me'')))');
insert into msgquery (count,id,iconid,shortname,name,sql) values (0,998,998,'WFA','unanswered messages from me','select distinct m.id from message m, address a, addressxmessage axm, category c, categoryxmessage cxm where axm.messageid=m.id and axm.addressid=a.id and axm.type=''F'' and cxm.current=1 and cxm.messageid=m.id and cxm.categoryid in (select id from category where shortname in (''WFA'')) and a.id in (select id from address where shortname=(select shortname from address where address=(select v from conf where k=''me'')))');
insert into msgquery (count,id,iconid,shortname,name,sql) values (0,997,997,'TOM','messages to me',             'select distinct m.id from message m, address a, addressxmessage axm where m.date>date(''now'',''-30 days'') and axm.messageid=m.id and axm.addressid=a.id and axm.type in (''T'',''C'') and a.id in (select id from address where shortname=(select shortname from address where address=(select v from conf where k=''me'')))');

alter table message add count integer;
update message set count=0;

alter table category add iconid integer references icon(id);
alter table category add count integer; 
update category set count=0;

delete from conf where k='mailxel-db-version';
insert or replace into conf (k,v) values ('mailxel-db-version','0.7.4');