-- Copyright (C) 2007-2011 by Simon Hefti. All rights reserved.
--
-- Licensed under the EPL 1.0 (Eclipse Public License).
-- (see http://www.eclipse.org/legal/epl-v10.html)
--
-- Software distributed under the License is distributed on an "AS IS"
-- basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.
--
-- Initial Developer: Simon Hefti

-- person
create table person (
  id integer primary key,
  shortname text, -- JS
  name text, -- Joe Sixpack
  address text unique  -- main mail address, js@domain.name
);

-- describes a e-mail sender or recipient
create table address (
  id integer primary key,
  personid integer references person(id), 
  shortname text, -- JS
  name text, -- Joe Sixpack
  address text unique,  -- userid@domain.name
  isvalid integer, -- 1 valid 0 invalid
  ispreferred integer, -- which one (of many addresses of one user) is the preferred one?
  lastseen date, -- date of last contact with address
  count integer -- counts number of times we encountered this address
);

create index adr_short on address(shortname);
create index adr_adr on address(address);

-- GTD category
create table category (
  id integer primary key,
  shortname text,
  name text,
  deleted integer, -- boolean
  iconid integer references icon(id), -- attaches icon to category
  count integer -- counts use 
);



-- mail message

create table message (
  id integer primary key,
  uuid text, -- unique message id as defined by the sender
  date date, -- send or received time
  deleted integer, -- boolean
  nattach int, -- number of attachments
  azip text, -- zip file containing the attachments
  tme integer, -- boolean, mail is from myself
  fme integer, -- boolean, mail addressed to myself
  count integer, -- counts access times
  curcatid integer references category(id), -- last attributed category
  inreplyto text
);
create index msg_uuid on message(uuid);

create virtual table messagetext using fts3 (
  subject text,
  f text,
  t text,
  c text,
  b text,
  r text, -- all recipients
  a text, -- all attachments
  GTD text,
  body text
);

-- message references: message src references messages refid
create table msgxmsg (
  srcid integer references message(id),
  refid integer references message(id)
);

-- attachments
create table attachment (
  id integer primary key,
  messageid integer references message(id),
  name text, -- attachment file name
  md5 text -- md5 checksum if file, used for the detection of duplicates
);
-- reduces select time from 100ms to non-measurable
create index a_messageid on attachment(messageid);
create index a_md5 on attachment(md5);

-- cross table linking addresses and messages
create table addressxmessage (
  addressid integer references address(id),
  messageid integer references message(id),
  type text -- T(o), F(rom), C(c), B(cc)
);

create index axm_type on addressxmessage(type);
create index axm_msgid on addressxmessage(messageid);
create index axm_adrid on addressxmessage(addressid);
create index axm_msgidtype on addressxmessage(messageid,type);

create table categoryxmessage (
  categoryid integer references category(id),
  messageid integer references message(id),
  -- deprecated current integer, -- boolean, helper, indicates that this entry is the most recent
  date date -- categorization date
);

-- personalized icons
create table icon (
  id integer primary key,
  name text, --  
  data blob
);

-- ready-made, personalized queries searching for specific messages
create table msgquery (
  id integer primary key,
  shortname text,
  name text, --
  type text,
  iconid integer references icon(id),  
  sql text,
  count integer  
);


-- used to keep track of current schema version
create table conf (
  k text, -- key
  v text  -- value
);

-- log of sql statements used against this DB (only used for debugging purposes)
create table sqllog (
  date date,
  duration integer, -- in milliseconds
  sql text,
  args text
);

-- poor mans sequences  
create table sequence(
  name text primary key, 
  val integer
);

insert into sequence values ('message',     1000000);
insert into sequence values ('attachment', 10000000);
insert into sequence values ('address',       10000);
insert into sequence values ('category',       1000);
insert into sequence values ('msgquery',       1000);
insert into sequence values ('icon',           1000);
insert into sequence values ('person',        10000);

INSERT INTO icon VALUES(999,'act.png',     X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C0000029A4944415478DA7C93DF4B936114C7CF7EA838F7AEB9B981AB982BD91A6C928E8AA14DC809A1CCA89B181B195DAC5150B262F6F30F2808BCE8A25910416A4217A2B12B2F7205DEBC831C0861B0528613C2E57CD7B6777BDD3A672A0DD30E7C78CFF33CE77CCFF39CE77D4480A6D168A0BBBB1BAACC8708480A592F954A2BC81AC2170A05D8DADAAA04C5E3719090E3743A2B93552C226BC5625167B55A3B8D4663EFC6C64673369B95A0C87AB95C2671686C6CDC1630994CB0C72860130596138984DAEFF75F73B95C97188639BCB4B424CAE572DFB14001C50E1400AC06994C46E079BE98CFE7B5168BA54BA7D3990D0643D3ECEC6C4210846F0848611FC30A904C267787ABB1586C85E6D2E934E8F57A3B0A6BE9A828BE2D303D3DFD8F88542A05B95C0E32998C138BC595046A201EAB86E3B81A1CB7E1CE627090918042A1808E8E8E60381C5EB0DBEDCFE87650ECDEDCDCDCB25AADF6A954AA9EFF0928CD66737066666601CF1DAC5A6A2391542A55DEB9EE7DED3C126559B65C9DAC1FB8032D17EE82F244670F89E054EB7EC983C897E1E161AAF01B5136F7DE84F6A78B70F6E52A385E254388F748DF502558B427F91172D9E170582291481EFDABADBED7934CEBE9CAA204FB22ADAD65C9C79F692497C9BC1557255393BCFDFDFD94CCA3FF507BEEFA64BDBE3D841D678902CFB3598E83C18B2D364C1E2A974ADEDD1D8C202EB7DB7D6C6262A288FE0BE4D6F1FB9F688DBD7DA3CBF675138013FE56D3D6014CBDF91C2581E7C880CFE73B3A3A3A4AAFE41DED848298335E909FF284B092ADFA9C2D9E3EDB8FB1705424165361F8190804A861943C8534212A6A1EA2201DA401A947EA18CF7894F18E471B7A1F5FA11ED25B50CDCFCF77E1F703F2603710A9456A76A038EA97A874C87052F89578CF7F7C3246D5FF083000ADA22BE681965B640000000049454E44AE426082');
INSERT INTO icon VALUES(998,'clock_go.png',X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000002E94944415478DAA492DB4B545114C6BF73D1712ECC4CEA7499461B671C0D1BEC260A950583096520F9302A24F5E0833D06D143451154FF81F5A24F0A8A86CA88E0431862544E17F282E465726EE02567423DA39E3397D3DEC79988E8AD05DF399CB5D7EF5B67EFBD98A17B2CD4D9CC119E431D002BF6C39F4862C4F92C554D3F661FB013FF5ADF95E4155E8CC3C264691F9E3CEFBE70B8B0DC268A7B783D32B09525FA1B5258DBA4D52267BA25A8AC676AEA1AF42A550E5683D3DFA7C6FB2AC4B8F094DFDA916F965DACBF6C3095DA82FE002627BDC82B6F54173BABAF64DF2956DA1DFFB184A5D90978860650555509D3A1D213B68A7AF587D1EE10BF23E1ACCCB29699292FE6E7FD30B89EC3E174C2A8D160703488A305166872EC38E83443D039313E761FA5A556180F682C9465C93ED4C9BD283335F54D814B1C0EE8D56AA5B36F69112999C15A44C6DBCF2CB28811ADA1B594A12C2BC53137F6665A349D72C366B341939D0D966114034110C0B1805EC7C26A56E1FD1709C6DC22984EBB4119CAB2B28C17DB91C0FCB1B2730AB4B5BB8BC0C686227F20880831A1DA1663C8CBE530E1FD8992F24BA00C6559C71CE3BBF68A59CFD19993E92BC2B1FC7C45DBDB04D2E97ECB6E31E2E3D70D68F596246528CBDBE680042065B12C926998C6D59A1AB85C2EDC7DD48B14A3850C9E8801C37160492D6528CBC7F79BAE6843A1188A8AF499BFE8E9EBC38DE666787ADA322962006C4A12B8703846B8159A63A901D1A7F8F0F01A4FDC13A994526CC8CD45774F8FF2CE48673442456E68CFE35953186A2091C71E30B2DED5B590130E0BC9B441C6E4CF489135C3EAAA10EEEC5CA08CA41890A34CC8F2AA108DB62FB6B4CCC8CBCB318EECF1EFA0392E188CCD3435CD6C4522ED94A12CDF6636676AC4CA6834D4585B1BB3B7B63A0ADCEE7CADDDAE4CD48ECFB71BE8EFDF58EAE858EC4D24A25EB359CC408C3A3D75E4646F1B18C6F7441066C9615D27293A1885E9BA20D13B325E838F753AE7A62CDBC9765E2A06B22CE37FE29700030007544F4DCEB8CF840000000049454E44AE426082');
INSERT INTO icon VALUES(997,'to_me.png',   X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000000017352474200AECE1CE900000006624B474400FF00FF00FFA0BDA793000000097048597300000B1300000B1301009A9C180000000774494D4507DA0215112624804FCF96000002884944415438CB95915F48536118C69F73E6E636DD96E872D35466E61F966B62A14D2FB2C22414E288104341080A8920A2A81B05BBEBA6AB6E065D647F60775E682625649A5AA64CD4412D9B88E110860B9DFBCEF9CECEF9BA3109B78A9E9B171E7EEFC3CBF37248A3028E3372C065008D7BD67B06F837184B1C6433905E5D154EE7B5BA86864A2ACBF83039E95E5D59D102F01D04F974DB2AD07AB8A0C0B9158B19A2D1A821C76A75AA406B3A36ED052A638E5BDD1EDDF1723B00603914D1B54E4F3BD2B12917F8DAF87EA3D95CE87639C01803630C6E970346B3B9D0D7C6F7FF334065E0BD6E29281382A424212949900981D72D055596CAA7183DC36AAF2D5B0EC536234422041221886D46882D5B0EF50CABBD7F0C10A63A7DC254672700282AF3CF8F8F84255184248A981F1F092B2AF3FFB5C478325E0BA0B6F9DD25DC1EB8F9F27EA0699B19AC008060606EBBAFE4ED27E04C4A80A671A879AED87BF4AA2CC9E873DFAB7D159AA8D268495DBDC6E43AE7A931D9EC767CD931658C253D8CAFE9262C30B0F17B00F764F505238AB86F58B4663C9B194593ECC595A20500C0E3F513B05436E2FAA3898700C260EAA8F2B4E51B0068C247BEB77D0C2EEDCC2EAF7045A5B9C6C1B149545BDB91E4AB40E271ACEE5AB096590D8B250B67ABEDA73928B9F15DE24C1C6BDF624BFE357EF1CEECC9CF811B6FB2A83EE7F5E03C4AB81694E737439665088200411040290500241214A74A73EBBA9ACA3A90143B7E9558CFD6675CDAFC1C3EEF5005F20C55A02201A514D1685405004AE9FEB71863D0F29C11E28F6200460EC079BEE2E205D8DCF5E03494E94C09A6CF8973BA2CE2FAFA60060016CBEE7AA0D24C4E91F49C22E9A1CA3A440213CAC2F3210E801640D1DEFC1FC900D67F026A931264BFFBAF6B0000000049454E44AE426082');
INSERT INTO icon VALUES(996,'inbox-table.png',X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000002314944415478DA9C93CF6B134114C7BFBB9D7493B5A936D8D236443609B60D9516FC51B517D1A67A28E241F1E049F0A277050FB507E93F2082FE11A57810F1E0514850A11E4C4B2926F4A22EA5108D4DDC243B3BBEB7C9A64505AB0F8637CC7E3FDF79B3F346BBB6B0000E4DD32E531AC6FEE2B352EA394F842765B0185F5E5C7CBA1FFAEAFCFC9D602E4E555E43A349CE3CAB7B4AE1D28A0672872463CFF37ECB6F2E1C84EBBAFA742D0F459C7E7A278733D5DCEDB964F4AE54CA779D4D6B7ECEA65A836326D9FAC61AD632C3ACA0E51171A06FE270DC4A0606AF8A0AA990037CA91221918D5005763BAB2858CB4C7DA73CA24B0F89FECCF471E94AB8546250414AFCC0BDF118EE4FF4231B2EE3C189613FB386B53E43ACA05D2DA5E95D742EB87B2A38DF0DBC2F16FDB39BE130F2ABABFE37D6B096196675321BED19B062BC28F754C071CCB230994EA3E638383936D6FA07A461ADCF102B5C0FB1DEC12343C68B97B0B18D2BE52E7C5A4BA067721685CD4DBF82B0616065F9318CEF5BB037FA607C7887DEB97343CC8AA6875074301EB97EEB86BFC3388D67F912D6288F2612FE5AA154C280DE40E6E2544B337594538459E14A15722A15346AB54EA37CA36926FF041B6F1D706F18BA8E0AE58A6D7734DDA60966455322D4A033F208E2E64CEA8F1DB84D47EA0499322B6A4D984EB50AB75EDF6DF4F5F5BFB63357C62C1928B341065EFB063854FB3A7F0D7A70BB067413CC8AC2965A721E3D8CE03FE263194B6C492D8343FCB0FE9177697CFD29C0001D862126DCFDA4A50000000049454E44AE426082');

INSERT INTO icon VALUES(995,'star-small.png',X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000001614944415478DA62FCFFFF3F03258089814240B1012CC89CC3AB9918585919185821A21C40BC18886381F8C7EF3F0C0CBF7F3330D886FEC3EF0290A27F103546502123101F244EB417408AFFFE65B0E215321405D1B83463780168D36628CD0072B28E7298F1F3C7E73F0385EC9194F922EB61448EC6DD4B580C5858383A358D13CD797884F9FFFDFDCEC0C8C8CCF0E5D3F38F372EAE3AF9E7CFCF72D7983F17F079E1C29F3F3F2A2F9F9C7EF6F3B7C70C2FDF5D6678F6FA22C395B38BCF02355782E4F17AE1F1E3BF20EA350F3F9730C3FFEBFF7F7FFFF445409095E7FD4716E12F9F7EBEBE799F81C13506D500142F303232321426303818EBB14DFEF3F7FFDF6F5F7F9FE5E26631666666623E77E9576EFF028603E8299705CD45ECB71E3098494BFCBAB76E17C3CC63E7182ED918FFD10C7465C8068A5B01E5CF00F1177C2E00192800C4ACA0D804E25F40CC0C321888410ADF03D5FFC269C0D0CC4C00010600D8A199D519C258B10000000049454E44AE426082');

INSERT INTO icon VALUES(994,'tick.png',     X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000001E84944415478DA62FCFFFF3F032580898142C0022218670801598C4006900372D01F20C10D349B9911A20A443181E5E581782D9057C3F0F7FF8EFF11AFF1B8E0FB3F06865F500C32F0EF7F01867FFF27A6B9241903D92D40151EA478818DE11F439FA1BCBEE9972F5F18E29D62F419FE30B4C0BD4000300235D72B48C83BC80BC9497DFCFCF1F7C163876E005DD380EE020FA0FFCFC09C0676FA0FA0D3FF306408730906AB89AB287CF9FAE5DFD14B47EF005D3111A8760BC280FF404D7FFEB724F9271A8268301F22EEC3C1C49625C923A9FCE0C1038653974FDDFDF0E1C352A09AB90CBFFF2345E39F7F2D317E317ACF9E3D638AF08A3000F1819A7359FE33D54B8BCBA87EFDF395E5E587170F3F7DFAB0091880ED400C7121C280FF354B562CBCC4CEC9F6EBD4ED53CC0E768E3A401BE2C564C5357EB0FC607FF7E1CDD38FEFDEEF67F80B8C3E06867F2801044A898C7DFC0C400DA03068317636D37AFAF319A700A700C3FB6FEF197EBCF8F6FAE3DDF747189819921858993E30B042D30BC88759EF9102F13FC30EA0D36BCEEE38718DF92FE3D7D78CAF19BE7FF9FAE1D3CD771781219E0B54F101674A4431E4F35F86A79BEEB67099F0CB7CBFF0E90ED08179406B9EE24DCA2800984419DEFF61F8B6F34D0B30F9963008B25C0727635C8964C073234080010081D0DE163DA8B7A40000000049454E44AE426082');
INSERT INTO icon VALUES(993,'hourglass.png',X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000002374944415478DA62FCFFFF3F0308EC289498F0F6D917B34F6FBEB1FDFBFB9FE1CD6B0686D76F181858D998FEF30AB2FE1516630362D63FFCC2ACE77D27BF286080021618A39AADF1F4BA29B14EF75F7D7D2B29C8C929C2CB26FCF4FDF747DF7FFE65FCF1FB2FE3DF7FFF19E544B884C2FB979EF6654000261803E81246062200BA3A8A0D60419260E26463E662F9FEE8CF9FE7BB74BE896B31BD3DBB49EED3E74F2039063ED392AB5CD2065C2075B85C70D1B5694E8B90842A0B9342D80D4626967F8C2CEC7F195938FEF218155E1593D162F56C99DB025287D50020B800928CE85B34814F489A955DDCE4259B90C61B61F3D2CB520ABA2C51FD8BFAA19A2FE0320004CEFFFBF7EF827BD3AC1E2676C11F3C3AF1B7C5A59439C27A164C048983E4D1C3041E063F7FFE646064646460626262443718EA6FC6DFBF7F33C0D20D2E1798006D32D9559F5E041378FBF9E7DBD5A589B92071903CBA0B900D30059A6EBAB63C39FBCB8F3F1F9115BDFE0434A42C3907240F5287D500A00DA6875AB38B5F7DFCF9165BFCBFFAF8E3EDBEE6AC62903AAC61009460FAFEEBEF379EDB3DE67FF9C418BF8B6B30BF3BBF55FAD3E7CF607FF3F30B307C13E9B8035287D5803F7FFE80D97F7894DF32F20AB13073897100A3F1333BFB37503E6060E0E646518761C0AF5FBFD841F40FC9C03B82C0CCC406CC4C3C3A6A8F98913213505A08A60E061861D132C99671E6EBD70CC6EFDF03BD03147AF30588BF03B3332B03033F0F0383301F0383083F0383200FC3D9A2A3FFD3610600041800B9C811034A41FB920000000049454E44AE426082');
INSERT INTO icon VALUES(992,'eye.png',      X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000001D84944415478DAD4934D4B02511486EF38E50751531641848216B4506CA3603044054D2EA2A5B4709BEB76FD03FF408B164210B87261D02613260205C3A535AD42490A31A20FC3318DF1F69E41DBB670D58187F17ACEFB9E7BE7DC1138E76C98B0B0216368030161FEE81F6502AC01057881B35FF70A2A2007AE4073A01B180830D8B1D96C7B8AA22CC662B1594DD3C60A85829592B22C777D3E5F2B954A3DE772B9FB4EA79384EE8CFAD211EC603F140A1DE4F3793993C92C198631E572B9ACAD96CE0888ACF41FE5A8866A49636A45518CA0EB65A3D1E8E8BACE09555539453279CC65799D2BCA36C7AEF8204FB5A421ED085C76C3E1B013DBB776BB5DF35C8944029D0D76787864AE1716FCECF1F18E0DF2544B1A34DA25839352A934D56C3697EC082AF0783C4C558B6C6565D314D8ED36363AEAF935F84240F3405AD162B1D4ABD56AAF582C1AC160704692A4719C9769DA0DF37A97992439D15D631B1BABA671A552A9C7E3F173BC8B539A8A390298D034C20E87632B1289F8A3D1A8BF56ABCD95CBE571CA0702814FB7DB5D4FA7D3B7D96CF6B6DD6E5FE0155DF77A3D4E06229804D33071C26C1E4F37D6527F42E6AEC1074435889EF07CC3FA05BC0BFDDB48850E407317FEB87C74E3BE814EC6C2FFFF987E041800C236E044B979226C0000000049454E44AE426082');
INSERT INTO icon VALUES(991,'ignore.png',   X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C000002284944415478DA6C533D8F125114BDF301991118F9181213280814C856C682C66C62E30F70D7B5A0D56CE50FB0948EC44A130B498C1DB1D9FD03764A61B0341A30918DE12313A08009C8870378EEF8664236F3929377DFBBE79C37EFDE37522693216F2C160BC6D17EBF3FC5B20044BC14F04B92A48B4824F203F0352A1D0C59968F913CDDED7697C0ABCD6663F37E381C3690BB039C0317D8FAEC1B8442212F8E237E08E16BDBB6BB980FBD6D083F1986D1C7FC0CEB6FC0D4354826931EE936708553BB38912CCB3A3420D33449D334CE5D09EE17D78013622480A1B748A7D3D4ED76DD389FCF532C16F35243C1FD7F85542AE5C563E0AEB7E0FD5C2E47018305BF7D8344C237FB099C71D06AB58284542E974974E7836FC0774561F87E76369B551A8D06F57ABD4083D16844954A45E9F7FBF66AB5222EB4522A9508FDD5B6DBED71BD5E2774E039B812F0FD9AFE31722F9ACDE6D762B168606DE1BD38B2E33884CADF5BAFD7259CFCB65AAD3EF2AE726D9C718E39CC650D6BE5C96442C051AD567BD36EB7693A75DBAB0518689C630E7359C35A55F43BDEE90C68369BD170E876D2083030383718CC683E277E2771B788E3F1D87DC58AA293AE935B40DCCD0C303039A7EB3789B9D0C9AE700EBBE572D93939B9FFB250C853341A75DF5180419A73CC612E6B58CBD50EA30BB714457980B888C23CC15C07DE034B60276AF214385755F51DE60EBAF6115F6AB18122083700FEB3F642E408ECC55FAB0A2E6BFE027F80D53F010600A4A8F5200A77CFF10000000049454E44AE426082');
INSERT INTO icon VALUES(990,'bin.png',      X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000001974455874536F6674776172650041646F626520496D616765526561647971C9653C0000021E4944415478DA94534D6B1351143D930FDA043524549A18C42E420B8251D344D26A49A234AEBACDBA3BDD776171D75529B828A8251BE94637712134D0451B4986DA5A6CAAFE00D71D944C26E4839984CC3CEF7B2510D264910B6FCEE5BD77CF3BE73257628C81472693813E338349970B9224C1324D8E21FA3C03635F3B9DCE1F43D7E15114E47239F4C2868120C210AD171663CB54B4FC796323CB91F66631246C03C5B36DC348F3A2B960F0F5FBB5B51D22C297CDCD1DDA7F4EE7738304529F8515D3E95C7CB9BABADE3B54541537BD5ED86D97EF647777B71CDDEE3159C85F51D06EB703D9EDEDF5502884603088A9A969F87D77C0CC1B989C0820E0BF8B776F3EBC320CE3F6280B4AA15040AD56433E9F8742CDDADBFB04E5AF82FDFD8F68B4EA383C14CDBB184510482693228946A302E7630930C9426C210D060B89D40ADFBE355241A9541249B95CA6EE00E767B22038FB7E4068422EE6C7531079B42408E61F2761495D3C49A5C75040F1F3C79120383F2E910113DF8A07E3286078185F14D21F2C5D623C9518ADC0B2AC2B0A7E9D9E90740BBF8F4E8482D3A2CCEF0D57D06834FC833DB8BF101716EE2562446422FA348E56AB35DD4FE0E825D56AD521CB3227E2AFA0D96C42D334916B6E37AA9E0BFCF3F9F83DFB50025555DD914844733A9D5E9DA6CEE874E857AE40B70CB8AF4DC0E3B94E3E9956A9545C4309EAF5BA1A0E87DF9A34C6BD39E1CB4673C0C79B9071B4DBED6A3FC17F01060036EA13A304C2CF370000000049454E44AE426082');
INSERT INTO icon VALUES(989,'mail-forward.png',X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000000017352474200AECE1CE9000000097048597300000B1300000B1301009A9C180000000774494D4507D90C1C06361CBF4A53E9000002C24944415438CB7593CF6F944518C73FCFCCBBBBEDC252D258172D04850A5D49B5A12B2545948DD6040F6030468F5C4813C201FF000F70E000F10F3031DE4CD4108D1E6C628C820502261082DAA454281AA1EDB6ECD2FDF5BEBB33EF8C872D184B99E473993C9FEF3C933C8FF084F3DBC76AA316F68BE081F1DC87EEEE6A75B2F2E2DA69D5A3853752EBB2C33DB9FDFB407CF9E6F84FA6367759E05CFF71B7B86AC09553AA4B2BDE4CA6D78F3CDD3FBA27D33B988FBDD1A23441D01137EE5DFFB53435FE731C962E03E7FB8FBB0A804C9C546B94A2904CA55FCF6E2F0C773FBF6BD87997F43844694434A2342A48A074A259BD73E94279EAFB5F5CB37609B828E74FA863BDB9C2A1ECB65787BD9076DE21A240A976C00A749044F0F5F2F48FE74ABF7FFBA54E0CBDBB6FEBCED1231D2A4C24956B8BB2BA2C4A8308551B246FC9C0B64FAFA809351365A31D2F1D62EAC11AAA36589697431EA2FEA3DA524C1615B9BE51A66AD958596BD5BAF51B19DCF93E938B1D545A1A96BFF088E5A0337F0CF1F9F42676E4DE666D268BB556296BADB2DED399798697F31F70634EB3D45CD181281E44706321C3B5FA201767D762BDC75AAB026B8C58E730D6924AF7D037F00E57AF7F031223E2411CA26244041DA41919E9E5AB0B7771DE638D91C05AAB8C7334ADA5690C4BAD04F9D78E92EEECFCDF8035C290CFBE2EB2B414B37BF7B37C31F1176643211F586394758E6A18B2502E73765273A734B7EA787BEF8922CBFCBCE5955D9B98BCFDC2DEA01945BA1E45DC2B1679AABB9B9BB38BEC2DBC48AD66F1BE2DB5E536E5728B288A999E36BC7720DF1B94EFDF4FDD9A99E1B9CD9B49259358334BA5625858683E7AB9652DD54648230C31C610C731007FFEAD91CCC0C011E7DC9687C55D7B3E3A3C36767043BD1E639CA718194A510BEB3CCE7B2A514CADE900E8CBA61FDFC6ECD8779F78EF879EB4E65D07DF1A9A6F38FABA14FF9CFDE1EABF03AC44FE3F8461910000000049454E44AE426082');
INSERT INTO icon VALUES(988,'mail-reply.png',X'89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000000017352474200AECE1CE9000000097048597300000B1300000B1301009A9C180000000774494D4507D90C1C0634070719F887000002C64944415438CB7593CF6B5C6514869F73EE8FC94C924E12938E904A6BD5269356096970B41A9D41B388852EAAE04A10D4164A91FA27E8C28520B8155CB854294237A68898D66A68C514C30475D2C69468639AA6994E279D3B33F7BBF7739169B5253DF06E5EBEF739E78373840754F163DDE1081322586032FB5E7C75AB7772BF71F123ED73849712DB32B9BEEC441EC496E727BF0F3756CE0B9C193C11AF6D09B8F0A1A61DE5653FD57560FBE0F8739DFDC3A3910D1D5107D76D8B6ACBBFFEBC5E9A9C8A82F5F3C0D9C113F12D0039F781B6AB52F013A9173303855CCFA34FE7621BFB9618510711075107753DD4F11AD52BD33F964BDFFC103736A6819FE4ECFB7ABC3F5B389CD9F37CCE0AA9D8C68828A86E02EE93E3FA08F676F9D27767D6E74E7DE978FB5FCD3F3632FE4E9B069EAFF16650B60E8B3A2042D5B8FE823CB9E7B30B7A4E17EB99FADEA70E53BAD94ED5B8AD700B7247FA9FAA4DE5B75525FBF838A58D4CA4C618DDD6B583E191D7F96A69884FFECC43EB0B77D50255EA427105F6665FA1A3338331465D638C1A6B995EED66363A40EDD63A9586D29DBA778A9B7598BD1A313C7288B6542FC6DA16200CE5F41F554E1637181BEB676AAAC9CC5F162442C482C48846880803FB0EE2277A681A83A78A094371C3870BA35F5C2C932FECA25289683442460F1E23954CDEB360B52060796D8D441090F03C70DDCD09C2F627C6C65ED8C9FCFC6DBABA3C6C14F1EEC9952DD77B578FC36B43D7E9EBEEC6F17D4C18AAFBF61BCFF6178B1500AC8D19DAB7136BC15A8BB5B47CF03C6176E612E95C2FCBABAB7889048D7ADD71E7E62A773B942B7596FE09A805016118124511008EE3D0FB5007260C49A7D3B425932C2C2E52BE7123E1EEDEDDC1DCE52A576A4D6289684FF9C4498F3886D85A620B4D0BD75CA5F4FBC2CAC0336F7E7EA7A1AAFE2DDB8F9CFA25FFD6C4FED34B218F742AD7BFFE76E641272E2233D73E3D74F4FFDEBF289F223DE64EF4390000000049454E44AE426082');

insert into category (id,iconid,shortname,name,deleted) values (999,998,'SFL','s:schedule-for-later',0);
insert into category (id,iconid,shortname,name,deleted) values (998,993,'WFA','s:wait-for-answer',0);
insert into category (id,iconid,shortname,name,deleted) values (997,994,'DON','s:done',0);
insert into category (id,iconid,shortname,name,deleted) values (996,988,'ANS','s:answered',0);
insert into category (id,iconid,shortname,name,deleted) values (995,989,'FWD','s:forwarded',0);
insert into category (id,iconid,shortname,name,deleted) values (994,991,'IGN','s:ignore',0);
insert into category (id,iconid,shortname,name,deleted) values (993,992,'TON','s:took-note',0);
insert into category (id,shortname,name,deleted) values (992,'SFT','s:schedule-for-today',0);
insert into category (id,shortname,name,deleted) values (991,'POP','s:postpone',0);
insert into category (id,shortname,name,deleted) values (990,'UNC','s:uncategorized',0);

insert into category (id,iconid,shortname,name,deleted) values (989,995,'LKE','s:like',0);

-- create table msgquery (id, shortname, name, type, iconid, sql, count

INSERT INTO "msgquery" (id,shortname,name,type,iconid,sql,count) VALUES(899,'F-ACT','fever, number of unanswered messages to me','C',NULL, 'select
  count(id)
from
  message
where
  date>date(''now'',''-60 days'')
  and fme=0
  and tme=1
  and (julianday(''now'') - julianday(date)) > 1
  and curcatid not in (997,993,994)' ,0);

INSERT INTO "msgquery" (id,shortname,name,type,iconid,sql,count) VALUES(799,'F-ALL','count all messages','C',NULL,'select count(id)
from
  message',0);
  
INSERT INTO "msgquery" (id,shortname,name,type,iconid,sql,count) VALUES(995,'TOP','recent messages','M',null, 'select
  distinct m.id
from
  message m
where
  m.date>date(''now'',''-30 days'')
  and m.deleted=0' ,0);

INSERT INTO "msgquery" (id,shortname,name,type,iconid,sql,count) VALUES(996,'UTM','uncategorized messages to me','M',996, 'select
  distinct m.id
from
  message m
where
  m.date>date(''now'',''-30 days'')
  and m.deleted=0
  and m.tme=1
  and m.fme=0
  and m.curcatid=990',0);

INSERT INTO "msgquery" (id,shortname,name,type,iconid,sql,count) VALUES(997,'TOM','messages to me','M',997,'select
  distinct m.id
from
  message m
where
  m.date>date(''now'',''-30 days'')
  and m.deleted=0
  and m.tme=1',0);

INSERT INTO "msgquery" (id,shortname,name,type,iconid,sql,count) VALUES(998,'WFA','unanswered messages from me','M',998,'select
  distinct m.id
from
  message m
where
  m.date>date(''now'',''-30 days'')
  and m.deleted=0
  and m.curcatid=998
  and m.fme=1',0);

INSERT INTO "msgquery" (id,shortname,name,type,iconid,sql,count) VALUES(999,'ACT','unanswered messages to me',999,'M','select
  distinct m.id
from
  message m
where
  m.date>date(''now'',''-90 days'')
  and m.deleted=0
  and m.tme=1
  and m.fme<>1
  and m.curcatid not in (997, 996, 994, 993)',0);

-- last statement: set to current version
insert or replace into conf (k,v) values ('mailxel-db-version','0.9.3');
